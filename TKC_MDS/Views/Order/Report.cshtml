@{
	ViewData["Title"] = "Report";
}
<form id="kt_app_content" class="app-content flex-column-fluid" onsubmit="return false">
	<!--begin::Content container-->
	<div id="kt_app_content_container" class="app-container container-xxl">


		<!--begin::Row-->
		<div class="row gy-5 g-xl-10">
			<div class="col-xl-2  "></div>

			<!--begin::Col-->
			<div class="col-xl-8  ">
				<!--begin::Table Widget 5-->
				<div class="card card-flush h-xl-100">
					<!--begin::Card header-->
					<div class="card-header pt-7">
						<!--begin::Title-->
						<h3 class="card-title align-items-start flex-column">
							<span class="card-label fw-bold text-dark">พิมพ์รายงาน</span>
						</h3>
						<!--end::Title-->
						<!--begin::Actions-->
						<!--end::Actions-->
					</div>
					<!--end::Card header-->
					<!--begin::Card body-->
					<div class="card-body table-responsive">
						<span class="card-label fw-bold text-dark">เงื่อนไขรายงาน</span>
						<!--begin::Table-->
						<table class="table align-middle fs-6 gy-3  " id="kt_table_widget_5_table">
							<!--begin::Table head-->
							<!--begin::Table row-->
							<tbody>
								<tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
									<th class="text-end  text-gray-400 pe-3 min-w-100px">
										ลูกค้า :
									</th>
									<td class="text-end pe-3 min-w-50px">
										<select class="form-select form-select-sm form-select-solid w-200px" id="select_custumer" name="CustId">
											@*
											<option value="0" selected="selected" disabled="" data-select2-id="select2-data-3-8t7j">
												เลือกลูกค้า
											</option>
											<option value="1">4302-MITSUBISHI P/C</option>
											<option value="2">4303-TOYOTA </option>*@
										</select>
									</td>
									<th class="text-end  text-gray-400 pe-3 min-w-100px">
										ประเภทข้อมูล :
									</th>
									<td class="text-end pe-3 min-w-50px">
										<select class="form-select form-select-sm form-select-solid w-200px" id="select_dataType" name="DataType">
											@*<option value="0" selected="selected" disabled="" data-select2-id="select2-data-6-mm44"></option>
											<option value="1">4302-MITSUBISHI P/C</option>
											<option value="2">4303-TOYOTA </option>*@

										</select>
									</td>
								</tr>
								<tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
									<th class="text-end  text-gray-400 pe-3 min-w-100px">
										ประเภทรายงาน :
									</th>
									<td class="text-end pe-3 min-w-50px">
										<select class="form-select form-select-sm form-select-solid w-200px" name="ReportType">
											@*<option value="1" data-select2-id="select2-data-9-lsju">แผนการส่งของ</option>*@
										</select>
									</td>
								</tr>
								<tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
									<th class="text-end  text-gray-400 pe-3 min-w-100px">
										เดือนรายงาน :
									</th>
									<td class="text-end pe-3 min-w-50px">
										<select class="form-select form-select-sm form-select-solid w-200px" name="ReportMount">
											@*<option value="1" data-select2-id="select2-data-12-7me1">06-2023</option>
											<option value="1">07-2023</option>
											<option value="1">08-2023</option>*@
										</select>
									</td>
								</tr>
								<tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
									<th class="text-end  text-dark pe-3 min-w-100px">
										เพิ่มเติม
									</th>
								</tr>
								<tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
									<th class="text-end  text-gray-400 pe-3 min-w-100px">
										Plant :
									</th>
									<td class="text-end pe-3 min-w-50px">
										<select class="form-select form-select-sm form-select-solid w-200px" name="Plan">
											@*<option value="1" data-select2-id="select2-data-15-nlkk">All</option>*@
										</select>
									</td>
								</tr>
								<tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
									<th class="text-end  text-gray-400 pe-3 min-w-100px">
										Period :
									</th>
									<td class="text-end pe-3 min-w-50px">
										<select class="form-select form-select-sm form-select-solid w-200px" name="Period">
											@*<option value="1" data-select2-id="select2-data-18-2vhz">All</option>*@
										</select>
									</td>
								</tr>
								<tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
									<th class="text-end  text-gray-400 pe-3 min-w-100px">
										Due Time :
									</th>
									<td class="text-end pe-3 min-w-50px">
										<select class="form-select form-select-sm form-select-solid w-200px" name="DueTime">
											@*<option value="1" data-select2-id="select2-data-21-tssa">All</option>*@
										</select>
									</td>
								</tr>
								<tr class="text-start  fw-bold fs-7 text-uppercase gs-0">
									<th class="text-end  text-gray-400 pe-3 min-w-100px">
										P/N ลูกค้า :
									</th>
									<td class="text-start pe-3 min-w-50px">
										<input type="text" name="PNCust" id="">
									</td>
								</tr>
								<!--end::Table row-->
								<!--end::Table head-->
							</tbody>
						</table>
						<!--end::Table-->
						<div class="d-flex justify-content-center">
							<button type="button" class="btn btn-sm fw-bold btn-primary me-2" onclick="openFile()">เปิดรายงาน</button>
							<button type="button" class="btn btn-sm fw-bold btn-secondary">ยกเลิก</button>
						</div>

					</div>

					<!--end::Card body-->
				</div>
				<!--end::Table Widget 5-->
			</div>
			<!--end::Col-->
		</div>
		<!--end::Row-->
	</div>
	<!--end::Content container-->
</form>

@*
<div style="width:100%;height:2480px;background:pink;">
	<style>
		.page-header{
			width:100%;
			height:2rem;
			font-size:1.5rem;
			/*centertext*/
			display:flex;
			flex-direction:column;
			justify-content:center;
			text-align:center;
		}
		.title-header{
			display:flex;
			justify-content:space-between;
			width: 100%;
			& > *{
				font-size: 1.3rem;
				&:nth-laschild(){
					font-size:0.7rem;
				}
			}
		}
		.title-table{
			border-bottom: 2px solid black;
			padding-top:3px;
			padding-bottom: 3px;
			width:100%;
			background-color:aqua;

			display:flex;
			grid-auto-columns: 5rem 3rem 10rem 5rem 15rem repeat(32,auto);
			& > *{
				height:1.3rem;
				padding:3px;
				border-top: 2px solid black;
				/*center text*/
				display:flex;
				flex-direction:column;
				justify-content:center;
				text-align:center;
			}
		}
		.factory{
			display:block;
			height:1.5rem;
			width: 100%;
			margin:0;
			padding:2rem;
		}
	</style>
	<p class="page-header">
		MASTER DELIVERY SCHEDULE
	</p>
	<div>
		<span>Issue Date 20/10/2023 Time 14:56:48</span>
		<span>CUSTOMER: 4211 - IMCT PARTS FOR NOVEMBER 2023 Data Type: 01</span>
		<span>Page 1 of </span>
	</div>
	<p class="factory">Factory: 2 Plant: SPIMIT</p>
	<div class="title-table">
		<div>MOD</div>
		<div>KbNo</div>
		<div>CUST PART</div>
		<div>TKC PART</div>
		<div>PART NAME</div>
		<div>1</div>
		<div>2</div>
		<div>3</div>
		<div>4</div>
		<div>5</div>
		<div>6</div>
		<div>7</div>
		<div>8</div>
		<div>9</div>
		<div>10</div>
		<div>11</div>
		<div>12</div>
		<div>13</div>
		<div>14</div>
		<div>15</div>
		<div>16</div>
		<div>17</div>
		<div>18</div>
		<div>19</div>
		<div>20</div>
		<div>21</div>
		<div>22</div>
		<div>23</div>
		<div>24</div>
		<div>25</div>
		<div>27</div>
		<div>28</div>
		<div>29</div>
		<div>30</div>
		<div>31</div>
		<div>TOTAL</div>
	</div>
</div>
*@
<script>
	const openFile = ()=>{
		let form = document.getElementById("kt_app_content");
		let formData = new FormData(form);
		fetch("/order/PrintReportPDF",{method:"post",body:formData}).then(res => res.blob()).then(blob => {
			console.log(blob)
			if (blob.error) {
				Swal.fire('เกิดข้อผิดพลาด '+data.error);
				return;
			}
			if (blob) {
				window.open(URL.createObjectURL(blob), "_blank")
			}
		}).catch(error => console.log(error));
	}

	window.onload = async () => {
		let select_custumer = document.getElementById("select_custumer");
		const listUser = await fetch("/order/JsonCustumer");
		const users_json = await listUser.json();
		select_custumer.innerHTML = users_json.reduce((prev, curr) => prev += `<option value="${curr?.custID}">${curr?.custID}-${curr?.custName} </option>`, `<option selected> </option>`);

		const dataType = await fetch("/order/JsonDataType_MS");
		const data_type = await dataType.json();
		let select_dataType = document.getElementById("select_dataType");
		select_dataType.innerHTML = data_type.reduce((prev, curr) => prev += `<option value="${curr?.typeCode}">${curr?.typeCode}-${curr?.typeName}</option>`, "<option selected></option>");
	}
</script>